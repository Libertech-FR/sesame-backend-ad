param (
    [string]$user,
    [string]$oldp,
    [string]$newp
)
try{
    Set-ADUser -Identity $user -CannotChangePassword $false
    Set-ADAccountPassword -Identity $user -OldPassword (ConvertTo-SecureString -AsPlainText $oldp -Force) -NewPassword (ConvertTo-SecureString -AsPlainText $newp -Force)
    Set-ADUser -Identity $user -CannotChangePassword $true
}catch{
    Write-Host $_
    exit 1
}
Set-ADUser -Identity $user -CannotChangePassword $true
WriteHost "Password changed"
Exit 0
